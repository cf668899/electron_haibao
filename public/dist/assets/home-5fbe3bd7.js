import{_ as e,r as t,o as a,f as i,w as p,a as s,b as l,d as n,t as o,n as d,g as r,p as c,e as h,c as u,F as m,h as y,i as g,v as f}from"./index-4c5e09e9.js";const w={name:"applist",props:["appType","list"],emits:["addApp","startApp","showApp","closeApp","delApp"],data:()=>({test:""}),methods:{indexMethod(e){return this.list.length-e},addApp(){this.$emit("addApp",{name:"",type:this.appType,isActive:!1})}}},v={class:"header-box"},A=(e=>(c("data-v-b3cea9e2"),e=e(),h(),e))((()=>l("div",{style:{"font-size":"15px"}},"会话列表",-1))),b={style:{"padding-left":"20px"}};const k=e(w,[["render",function(e,c,h,u,m,y){const g=t("el-tag"),f=t("Aim"),w=t("el-icon"),k=t("el-header"),_=t("el-table-column"),T=t("el-space"),x=t("el-button"),L=t("el-table"),C=t("el-card"),R=t("el-main"),S=t("el-container");return a(),i(S,{class:"common-layout"},{default:p((()=>[s(k,null,{default:p((()=>[l("div",v,[A,l("div",b,[s(g,{type:"success",effect:"dark"},{default:p((()=>[n(o("会话:"+h.list.length+"/5"),1)])),_:1})]),l("div",{class:"addAppBtn",onClick:c[0]||(c[0]=(...e)=>y.addApp&&y.addApp(...e))},[s(w,{size:"12"},{default:p((()=>[s(f)])),_:1}),n(" 新增:"+o(h.appType),1)])])])),_:1}),s(R,null,{default:p((()=>[s(C,{class:"box-card"},{default:p((()=>[s(L,{data:h.list,style:{width:"100%"},size:"small","show-overflow-tooltip":""},{default:p((()=>[s(_,{label:"序号",type:"index",index:y.indexMethod,width:"80"},null,8,["index"]),s(_,{prop:"createTime",label:"创建于",width:"150"}),s(_,{prop:"updateTime",label:"最后修改",width:"150"}),s(_,{prop:"record",label:"会话记录",width:"150"},{default:p((e=>[s(T,{wrap:""},{default:p((()=>[l("div",{class:d(e.row.online?"online online-box":"online-box")},null,2),l("div",null,o(e.row.record?e.row.record:h.appType+" "+(h.list.length-e.$index)),1)])),_:2},1024)])),_:1}),s(_,{prop:"name",label:"用户名",width:"auto"}),s(_,{prop:"remark",label:"备注信息",width:"auto"}),s(_,{label:"操作"},{default:p((t=>[t.row.isActive?(a(),i(x,{key:0,size:"small",type:"success",onClick:a=>e.$emit("showApp",t.row)},{default:p((()=>[n("显示")])),_:2},1032,["onClick"])):r("",!0),t.row.isActive?(a(),i(x,{key:1,size:"small",type:"warning",onClick:a=>e.$emit("closeApp",t.row)},{default:p((()=>[n("关闭")])),_:2},1032,["onClick"])):r("",!0),t.row.isActive?r("",!0):(a(),i(x,{key:2,size:"small",type:"primary",onClick:a=>e.$emit("startApp",t.row)},{default:p((()=>[n("启动")])),_:2},1032,["onClick"])),t.row.isActive?r("",!0):(a(),i(x,{key:3,size:"small",type:"danger",onClick:a=>e.$emit("delApp",t.row)},{default:p((()=>[n("删除")])),_:2},1032,["onClick"]))])),_:1})])),_:1},8,["data"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-b3cea9e2"]]),{clipboard:_}=require("electron"),T={name:"applist",props:["data"],emits:["reply"],data:()=>({replys:[{title:"打招呼",value:"hello"},{title:"打招呼2",value:"hello world"},{title:"掘金",value:"掘金项目"}]}),methods:{copyReply(e){_.writeText(e.value,e.title),this.$emit("reply",this.data,e.value)}}},x={class:"tab-box"},L=(e=>(c("data-v-25fd3d5d"),e=e(),h(),e))((()=>l("div",{class:"tab-box-title"},"快捷回复",-1))),C={class:"reply-box"};const R=e(T,[["render",function(e,i,d,r,c,h){const g=t("el-button"),f=t("el-tooltip");return a(),u("div",x,[L,l("div",C,[(a(!0),u(m,null,y(c.replys,((e,t)=>(a(),u("div",{key:t},[s(f,{class:"box-item",effect:"dark",content:e.value,placement:"right"},{default:p((()=>[s(g,{onClick:t=>h.copyReply(e),style:{width:"100%"}},{default:p((()=>[n(o(e.title),1)])),_:2},1032,["onClick"])])),_:2},1032,["content"])])))),128))])])}],["__scopeId","data-v-25fd3d5d"]]);window.require&&window.require("electron")||window.electron;const S=require("path"),M=require("ee-core/ps");const N=e({name:"webviewx",props:["data"],emits:["changeRecord","online","changeMessageNum"],components:{QuickReply:R},data(){return{preload:"file://"+S.join(M.getHomeDir(),`${this.data.type}.js`),srcMap:{Whatsapp:"https://web.whatsapp.com",Telegram:"https://web.telegram.org"},view:null}},created(){this.init()},methods:{reply(e,t){console.log("回复：",t),(e.type="Telegram")&&this.tgReplay(t)},tgReplay(e){var t;null==(t=this.view)||t.executeJavaScript(`\n            var inputReply = document.getElementsByClassName('input-message-input')\n            if(inputReply.length){\n              inputReply[0].textContent ='${e}'\n              inputReply[0].dispatchEvent(new Event('input'));\n              document.getElementsByClassName('btn-send')[0].click()\n            }\n          `)},init(){this.$nextTick((()=>{let e=this.$refs[this.data.id];this.inject(e)}))},inject(e){"Telegram"==this.data.type&&this.injectTg(e)},injectTg(e){e.addEventListener("dom-ready",(()=>{this.view=e,e.openDevTools(),e.addEventListener("ipc-message",(e=>{console.log(e);let t=JSON.parse(e.channel);"changeRecord"==t.type&&this.$emit("changeRecord",{id:this.data.id,record:t.data,type:this.data.type}),"online"==t.type&&this.$emit("online",{id:this.data.id,type:this.data.type}),"changeMessageNum"==t.type&&this.$emit("changeMessageNum",{id:this.data.id,type:this.data.type,data:t.data})})),setTimeout((()=>{e.send("translateOpen","开启翻译")}),2e3)}))}}},[["render",function(e,p,s,l,n,o){const d=t("webview");return s.data.isActive?(a(),i(d,{key:0,ref:s.data.id,id:s.data.id,style:{height:"100%"},src:n.srcMap[s.data.type],partition:"persist:"+s.data.id,nodeintegration:"",preload:n.preload,useragent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"},null,8,["id","src","partition","preload"])):r("",!0)}],["__scopeId","data-v-f0aa9c2b"]]),$=""+new URL("whatsapp-90c423fc.png",import.meta.url).href,O=""+new URL("Telegram-53e076b5.png",import.meta.url).href,{ipcRenderer:W}=window.require&&window.require("electron")||window.electron||{},q={components:{AppList:k,WebViewX:N},data:()=>({isReduceLeft:!1,test:"",id:"",appList:{Whatsapp:[],Telegram:[]},appType:"Whatsapp",pageType:"manager",apps:[],appTypes:[{name:"Whatsapp",image:$},{name:"Telegram",image:O}],srcMap:{Whatsapp:"https://web.whatsapp.com/",Telegram:"https://web.telegram.org/"}}),created(){this.listApp()},methods:{arrowLeft(){this.isReduceLeft=!this.isReduceLeft},moreSetting(){this.pageType="setting",this.appType=type},toAppManager(e){this.pageType="manager",this.appType=e},toApp(e){this.id=e.id,this.pageType="app";for(let t of this.apps)e.id!=t.id?t.isShow=!1:t.isShow=!0},addApp(e){console.log("add app"),W.invoke("controller.app.add",e).then((t=>{t.id&&(this.appList[e.type]?this.appList[e.type].unshift(t):this.appList[e.type]=[t])}))},startApp(e){W.invoke("controller.app.savePreload",JSON.parse(JSON.stringify(e))).then((e=>{console.log(e)})),this.id=e.id;let t=null;for(let i of this.apps)i.isShow=!1,i.id==e.id&&(t=i,i.isShow=!0,i.isActive=!0);t||(e.isShow=!0,e.isActive=!0,this.apps.push(e));let a=this.appList[e.type];for(let i of a)e.id!=i.id||(i.isActive=!0,i.isShow=!0,t=i);this.pageType="app"},showApp(e){this.id=e.id;for(let t of this.apps)e.id!=t.id?t.isShow=!1:t.isShow=!0;this.pageType="app"},closeApp(e){for(let a of this.apps)a.id==e.id?(a.isActive=!1,a.online=!1):a.isShow=!1;let t=this.appList[e.type];for(let a of t)e.id==a.id&&(a.isActive=!1,a.isShow=!1,a.online=!1)},delApp(e){W.invoke("controller.app.del",JSON.parse(JSON.stringify(e))).then((t=>{let a=this.appList[e.type],i=[];for(let p of a)e.id!=p.id&&i.push(p);this.appList[e.type]=i}))},changeRecord(e){W.invoke("controller.app.changeRecord",e).then((t=>{for(let i of this.apps)e.id==i.id&&(i.record=e.record,i.online=!0);let a=this.appList[e.type];for(let i of a)e.id==i.id&&(i.record=e.record,i.online=!0)}))},online(e){for(let a of this.apps)e.id==a.id&&(a.online=!0);let t=this.appList[e.type];for(let a of t)e.id==a.id&&(a.online=!0)},changeMessageNum(e){let t=this.appList[e.type];for(let a of t)e.id==a.id&&(a.messageNum=e.data)},listApp(){W.invoke("controller.app.list").then((e=>{e.sort(((e,t)=>t.sort-e.sort));const t={};for(const a of e)t[a.type]?t[a.type].push(a):t[a.type]=[a];this.appList=t}))},loginOut(){this.$router.back()}}},z={class:"common-layout"},j={class:"menu-box"},E={class:"menus"},I=["src"],J=["onClick"],B={class:"userinfo"},D={class:"username"},U=(e=>(c("data-v-409e558b"),e=e(),h(),e))((()=>l("span",null,"更多操作",-1))),X={class:"operator-box"},H={class:"logout"};const K=e(q,[["render",function(e,r,c,h,w,v){const A=t("User"),b=t("el-icon"),k=t("el-badge"),_=t("el-menu-item"),T=t("el-sub-menu"),x=t("setting"),L=t("el-menu"),C=t("el-button"),R=t("ArrowLeft"),S=t("el-aside"),M=t("AppList"),N=t("WebViewX"),$=t("el-main"),O=t("el-container");return a(),u("div",z,[s(O,null,{default:p((()=>[s(S,{style:{height:"100%","background-color":"rgb(253, 253, 253)"},class:d(w.isReduceLeft?"boxLeftReduce":"boxLeftNoReduce")},{default:p((()=>[l("div",j,[l("div",E,[s(L,{"default-active":"Whatsapp",class:"el-menu-vertical-demo"},{default:p((()=>[(a(!0),u(m,null,y(w.appTypes,((e,t)=>(a(),i(T,{index:e.name,key:t},{title:p((()=>[l("img",{src:e.image,class:"iconImage"},null,8,I),l("span",{onClick:t=>v.toAppManager(e.name)},o(e.name),9,J)])),default:p((()=>[(a(!0),u(m,null,y(w.appList[e.name],((t,n)=>g((a(),i(_,{key:t.id,class:d(t.id==w.id?"active-bg":""),onClick:e=>v.toApp(t),index:t.id},{title:p((()=>[l("div",{class:d(t.online?"online online-box":"online-box")},null,2),s(b,null,{default:p((()=>[s(A)])),_:1}),l("div",B,[s(k,{value:t.messageNum,hidden:!t.messageNum},{default:p((()=>[l("div",D,o(e.name?e.name:t.record?t.record:e.name+" "+(w.appList[e.name].length-n)),1)])),_:2},1032,["value","hidden"])])])),_:2},1032,["class","onClick","index"])),[[f,t.isActive]]))),128))])),_:2},1032,["index"])))),128)),s(_,{index:"more",onClick:r[0]||(r[0]=e=>v.moreSetting()),style:{"border-top":"1px solid #409eff"}},{default:p((()=>[s(b,null,{default:p((()=>[s(x)])),_:1}),U])),_:1})])),_:1})]),l("div",X,[l("div",H,[s(C,{type:"warning",class:"quiteButton",style:{width:"80%"},onClick:v.loginOut},{default:p((()=>[n("退出")])),_:1},8,["onClick"]),l("div",null,[s(b,{onClick:v.arrowLeft,class:d(w.isReduceLeft?"arrowLeftTransform":"")},{default:p((()=>[s(R)])),_:1},8,["onClick","class"])])])])])])),_:1},8,["class"]),s($,null,{default:p((()=>[g(s(M,{"app-type":w.appType,list:w.appList[w.appType]?w.appList[w.appType]:[],onAddApp:v.addApp,onStartApp:v.startApp,onCloseApp:v.closeApp,onShowApp:v.showApp,onDelApp:v.delApp},null,8,["app-type","list","onAddApp","onStartApp","onCloseApp","onShowApp","onDelApp"]),[[f,"manager"==w.pageType]]),(a(!0),u(m,null,y(w.apps,((e,t)=>g((a(),i(N,{data:e,onChangeRecord:v.changeRecord,onOnline:v.online,onChangeMessageNum:v.changeMessageNum,key:t},null,8,["data","onChangeRecord","onOnline","onChangeMessageNum"])),[[f,"app"==w.pageType&&e.isShow]]))),128))])),_:1})])),_:1})])}],["__scopeId","data-v-409e558b"]]);export{K as default};
